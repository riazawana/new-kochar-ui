
<div class="row">
  <div class="containt">
      <div class="sub-heading">
       
          <h3>Smart Meter</h3>
          <hr>
       </div>

      <div class="main">
          
        <div class="row" *ngFor="let l of modbus" style="padding: 1%;width: 100%;">
          <div class="col-sm-12"  style="margin-bottom: 2%;" *ngIf="l.gateways.length != 0">
            

            <mat-accordion>
              <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
              <mat-expansion-panel-header>
              <mat-panel-title>
                <p>Zone: {{l.zone_name}}</p>
              </mat-panel-title>
              <mat-panel-description>
                <p>Location: {{l.location_name}}</p>              
              </mat-panel-description>
              </mat-expansion-panel-header>
        <div *ngIf="l.gateways.length != 0">
          <div class="row" *ngFor="let g of l.gateways; let j = index;" style="padding: 1%;width: 100%;">


              <mat-accordion style="width: 100%;">
              <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
              <mat-expansion-panel-header>
              <mat-panel-title>
                {{g.name}}
              </mat-panel-title>
              <mat-panel-description>
                <a (click)="openDialog(g.mac_id,g.version)">Command Settings</a>
              </mat-panel-description>
              </mat-expansion-panel-header>
            <div class="row" *ngIf="g.smartmeter.length != 0" style="width: 100%;margin:0%">
              
              <div class="col-sm-4"  *ngFor="let s of g.smartmeter;let i = index">

                <div style="border: 2px solid;
                padding: 3%;
                border-radius: 5%;">

              

                  <div style="text-align: center;" *ngIf="finalmodbus[j][i].length != 0">
                      <table class="table table-bordered">
                          <thead>
                            <tr>
                              <th>{{finalmodbus[j][i][0].kwhm[0]}}</th>
                              <th>{{finalmodbus[j][i][0].kwhm[1]}}</th>
                              <th>{{finalmodbus[j][i][0].kwhm[2]}}</th>
                              <th>{{finalmodbus[j][i][0].kwhm[3]}}</th>
                              <th>{{finalmodbus[j][i][0].kwhm[4]}}</th>
                              <th>{{finalmodbus[j][i][0].kwhm[5]}}</th>
                              <th>{{finalmodbus[j][i][0].kwhm[6]}}</th>
                            </tr>
                          </thead>
                        </table>
                        <p><b>Kilo Watt-Hour (Monthly)</b></p>
                  </div>

                  <div style="text-align: center;" *ngIf="finalmodbus[j][i].length != 0">
                      <table class="table table-bordered">
                          <thead>
                            <tr>
                              <th>{{finalmodbus[j][i][1].kwht[0]}}</th>
                              <th>{{finalmodbus[j][i][1].kwht[1]}}</th>
                              <th>{{finalmodbus[j][i][1].kwht[2]}}</th>
                              <th>{{finalmodbus[j][i][1].kwht[3]}}</th>
                              <th>{{finalmodbus[j][i][1].kwht[4]}}</th>
                              <th>{{finalmodbus[j][i][1].kwht[5]}}</th>
                              <th>{{finalmodbus[j][i][1].kwht[6]}}</th>
                            </tr>
                          </thead>
                        </table>
                        <p><b>Kilo Watt-Hour (Today)</b></p>
                  </div>

                  <div style="text-align: center;" *ngIf="finalmodbus[j][i].length != 0">
                     <div class="row">
                         <div class="col-sm-5" style="border: 2px solid black;"><p style="margin:0%"><b>{{finalmodbus[j][i][2].kvhm}} kVAh</b></p></div>
                         <div class="col-sm-2"></div>
                         <div class="col-sm-5" style="border: 2px solid black;"><p style="margin:0%"><b>{{finalmodbus[j][i][3].kvht}} kVAh</b></p></div>

                      </div>
                      <div class="row">
                          <div class="col-sm-5"><p><b>Monthly</b></p></div>
                          <div class="col-sm-2"></div>
                          <div class="col-sm-5"><p><b>Today</b></p></div>

                       </div>

                       <p>Total Energy Consumtion</p>

                       <p><b>Smart Meter</b></p>

                       <p>{{i+1}}.{{s.smartmeter_name}}</p>

                  </div>
                  

                </div>

              </div>

             

            </div>

            <div>

        <button type="button" class="btn btn-primary" (click)="addsmartmeter(g.mac_id,g.client)" style="float: right;">Add Smart-Meter</button>

              </div>

            

              </mat-expansion-panel>
              </mat-accordion>

      </div></div></mat-expansion-panel></mat-accordion>

          </div>
        </div>

    
      </div>

  </div>
  
</div>



